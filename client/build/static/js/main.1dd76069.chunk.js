(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{123:function(e,t,a){e.exports=a(265)},128:function(e,t,a){},265:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(57),i=a.n(s),l=(a(128),a(48)),c=a.n(l),o=a(74),u=a(33),p=a(34),h=a(39),d=a(35),m=a(40);function f(e){var t=e.events.map(function(e){return r.a.createElement("li",null,e)});return r.a.createElement("div",{className:"Feed"},r.a.createElement("ul",null,0===e.events.length?r.a.createElement("li",null,"No recent activity"):t))}var v=a(111),g=a(132),y=a(269),E=a(271),b=a(264),k=a(270),j=a(267),P=a(266),S=function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(h.a)(this,Object(d.a)(t).call(this))).handleChange=function(t){var a=t.target,n=a.name,r=a.value;e.setState(Object(v.a)({},n,r))},e.state={graphParam:"pp_rank"},e}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props.data.map(function(e){return e.date=e.date.split("T")[0],e.accuracy=parseFloat(Math.round(100*e.accuracy)/100).toFixed(2),e}),t=r.a.createElement(g.a,{type:"number",tick:{fontSize:12},domain:[function(e){return Math.round(e-3)},100]}),a=r.a.createElement(g.a,{type:"number",tick:{fontSize:12},domain:[function(e){return Math.round(.9*e)},function(e){return Math.round(1.1*e)}]});return r.a.createElement("div",{className:"Graph"},r.a.createElement("div",{className:"graphSelect"},r.a.createElement("label",null,"Graph Options:"),r.a.createElement("label",null,r.a.createElement("input",{type:"radio",name:"graphParam",value:"pp_rank",checked:"pp_rank"===this.state.graphParam,onChange:this.handleChange}),"Global Rank"),r.a.createElement("label",null,r.a.createElement("input",{type:"radio",name:"graphParam",value:"pp_raw",checked:"pp_raw"===this.state.graphParam,onChange:this.handleChange}),"PP"),r.a.createElement("label",null,r.a.createElement("input",{type:"radio",name:"graphParam",value:"accuracy",checked:"accuracy"===this.state.graphParam,onChange:this.handleChange}),"Accuracy"),r.a.createElement("label",null,r.a.createElement("input",{type:"radio",name:"graphParam",value:"playcount",checked:"playcount"===this.state.graphParam,onChange:this.handleChange}),"Playcount")),r.a.createElement(y.a,{height:200,width:"100%"},r.a.createElement(E.a,{data:e,margin:{top:5,right:10,left:0,bottom:5}},r.a.createElement(b.a,{interval:"preserveStart",dataKey:"date",tick:{fontSize:10}}),"accuracy"===this.state.graphParam?t:a,r.a.createElement(k.a,{stroke:"#909090",fill:"white",strokeDasharray:"5 5"}),r.a.createElement(j.a,null),r.a.createElement(P.a,{type:"monotone",strokeWidth:2,dataKey:this.state.graphParam,stroke:"#ffa4b3"}))))}}]),t}(n.Component),C=function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(h.a)(this,Object(d.a)(t).call(this))).cleanText=function(e){var t=e.replace(/<\/?[^>]+(>|$)/g,"");return t=t.split(" ").slice(2).join(" ")},e.state={},e}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.props.info.events.map(function(t){return e.cleanText(t.display_html)});return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"topRow"},r.a.createElement("div",{className:"pCard"},r.a.createElement("div",{className:"profpicCont"},r.a.createElement("img",{src:"https://a.ppy.sh/"+this.props.info.id,alt:"avatar load fail"}),r.a.createElement("div",{className:"topleft"},this.props.pos)),r.a.createElement("div",{className:"Stats"},r.a.createElement("h3",null,this.props.info.username),r.a.createElement("p",null,"PP: ",this.props.info.pp_raw),r.a.createElement("p",null,"Global Rank: ",this.props.info.pp_rank),r.a.createElement("p",null,"Joined: ",new Date(this.props.info.join_date).toLocaleDateString())),r.a.createElement("div",{className:"Activity"},r.a.createElement(f,{events:t}))),r.a.createElement("input",{className:"toggle",type:"image",alt:"toggleButton",src:this.props.collapsed?"/assets/up.png":"/assets/down.png",onClick:function(){return e.props.getHistData(e.props.info.id)}})),this.props.collapsed&&r.a.createElement(S,{data:this.props.data}))}}]),t}(n.Component),w=function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(h.a)(this,Object(d.a)(t).call(this))).getActivity=function(){var e=Object(o.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch("https://osu.ppy.sh/api/get_user?k=259ac227b4133eddbb00cb52e15f47a635684f2e&u="+t).then(function(e){return e.json()}).then(function(e){return e}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),e.getHistData=function(t){e.state.collapsedpid===t?e.setState({collapsedpid:-1}):e.setState({collapsedpid:t}),fetch("http://localhost:4000/api/getAllInfo/"+t.toString()).then(function(e){return e.json()}).then(function(t){e.setState({histData:t.data})})},e.getPlayers=function(){fetch("http://localhost:4000/api/getInfo").then(function(e){return e.json()}).then(function(t){var a=[];t.data.forEach(function(t){a.push(e.getActivity(t.id))}),Promise.all(a).then(function(){var n=[],r=a.map(function(){var e=Object(o.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.then(function(e){return n.push(e[0])});case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}());Promise.all(r).then(function(){t.data=t.data.sort(function(e,t){return e.id-t.id}),n=n.sort(function(e,t){return e.user_id-t.user_id});for(var a=0;a<t.data.length;++a)t.data[a].events=n[a].events;e.setState({pdata:t.data})})})})},e.handleClick=function(t){var a=t.target.value;a===e.state.sortedBy?e.setState(function(e){return{isReversed:!e.isReversed}}):e.setState({sortedBy:a,isReversed:!1})},e.sortPList=function(t){switch(e.state.sortedBy){case"recent":return t.sort(function(e,t){return t.events.length-e.events.length});case"rank":return t.sort(function(e,t){return e.pp_rank-t.pp_rank});case"join_date":return t.sort(function(e,t){return new Date(e.join_date)-new Date(t.join_date)});default:console.log("test")}},e.state={pdata:[],histData:[],collapsedpid:-1,sortedBy:"recent",isReversed:!1,intervalIsSet:!1},e}return Object(m.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){if(this.getPlayers(),!this.state.intervalIsSet){var e=setInterval(this.getPlayers,9e5);this.setState({intervalIsSet:e})}}},{key:"componentWillUnmount",value:function(){this.state.intervalIsSet&&(clearInterval(this.state.intervalIsSet),this.setState({intervalIsSet:null}))}},{key:"render",value:function(){var e=this,t=r.a.createElement("h1",null,"Loading..."),a=this.sortPList(this.state.pdata),n=this.state.isReversed?a.reverse():a,s=0,i=n.map(function(t){return s+=1,r.a.createElement(C,{getHistData:e.getHistData,key:s,info:t,pos:s,collapsed:e.state.collapsedpid===t.id,data:e.state.collapsedpid===t.id?e.state.histData:null})});return r.a.createElement("div",{className:"App"},r.a.createElement("h1",null,"Waterloosu"),r.a.createElement("div",{className:"PDisplay"},r.a.createElement("div",{className:"SortPlayer"},r.a.createElement("label",null,this.state.isReversed?"\u2bc5":"\u2bc6"," Sort By: "),r.a.createElement("button",{value:"recent",onClick:this.handleClick,style:"recent"===this.state.sortedBy?{fontWeight:"bolder"}:{}},"Recently Active"),r.a.createElement("button",{value:"rank",onClick:this.handleClick,style:"rank"===this.state.sortedBy?{fontWeight:"bolder"}:{}},"PP/Rank"),r.a.createElement("button",{value:"join_date",onClick:this.handleClick,style:"join_date"===this.state.sortedBy?{fontWeight:"bolder"}:{}},"Join Date")),r.a.createElement("div",{className:"PInfo"},0===this.state.pdata.length?t:i)))}}]),t}(n.Component);i.a.render(r.a.createElement(w,null),document.getElementById("root"))}},[[123,2,1]]]);
//# sourceMappingURL=main.1dd76069.chunk.js.map